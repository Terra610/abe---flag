{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "CDI — Constitutional Divergence Index Schema",
  "version": "1.0",
  "description": "Defines the structure and validation rules for the CDI module within A.B.E., ensuring consistent representation of divergence metrics across domains, laws, and jurisdictions.",

  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "description": "Version of the CDI model definition."
    },

    "updated": {
      "type": "string",
      "format": "date-time",
      "description": "ISO timestamp when this schema or dataset was last modified."
    },

    "categories": {
      "type": "array",
      "description": "Constitutional domains or sectors being measured for divergence.",
      "items": {
        "type": "object",
        "required": ["key", "name", "divergence", "confidence"],
        "properties": {
          "key": {
            "type": "string",
            "pattern": "^[a-z0-9_-]+$",
            "description": "Machine-safe short identifier (e.g. 'speech', 'due_process')."
          },
          "name": {
            "type": "string",
            "description": "Readable name of the domain (e.g. 'Due Process', 'Search & Seizure')."
          },
          "divergence": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Divergence score, from 0.00 (faithful) to 1.00 (completely divergent)."
          },
          "confidence": {
            "type": "number",
            "minimum": 0,
            "maximum": 1,
            "description": "Confidence in this divergence measurement (0.00–1.00)."
          },
          "sources": {
            "type": "array",
            "description": "List of evidence or references supporting the divergence score.",
            "items": {
              "type": "string",
              "format": "uri"
            }
          }
        }
      }
    },

    "jurisdictions": {
      "type": "array",
      "description": "Optional list of jurisdiction-level modifiers for state or federal divergence.",
      "items": {
        "type": "object",
        "required": ["name", "modifier"],
        "properties": {
          "name": {
            "type": "string",
            "description": "State or jurisdiction name."
          },
          "modifier": {
            "type": "number",
            "minimum": -1,
            "maximum": 1,
            "description": "Adjustment factor applied to base divergence for this jurisdiction."
          }
        }
      }
    },

    "notes": {
      "type": "string",
      "description": "Optional freeform text commentary or methodology notes."
    }
  },

  "required": ["version", "categories"],
  "additionalProperties": false
}
