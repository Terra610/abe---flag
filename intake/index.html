<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Intake — Document + OCR Bridge | A.B.E.</title>
  <base href="/abe---flag/">
  <link rel="stylesheet" href="abe-patch/assets/abe-patch.css"/>
  <style>
    .intake-wrap{max-width:1100px;margin:0 auto;padding:1.4rem 1rem 3rem}
    .grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}
    .drop-zone{
      border:2px dashed rgba(255,255,255,.25);
      border-radius:10px;
      padding:1.2rem;
      text-align:center;
      cursor:pointer;
      background:rgba(10,14,22,.7);
    }
    .drop-zone.dragover{border-color:#5ddfff;background:rgba(20,28,45,.9)}
    .small{font-size:.9rem;color:#9fb3c8}
    .mono{font-family:ui-monospace,SFMono-Regular,Consolas,monospace}
    .out-block{
      background:#0f131a;
      border-radius:8px;
      border:1px solid rgba(255,255,255,.08);
      padding:.6rem .7rem;
      font-size:.85rem;
      max-height:260px;
      overflow:auto;
      white-space:pre-wrap;
    }
    label span{font-size:.9rem;color:#9fb3c8}
    .targets label{display:inline-flex;align-items:center;gap:.35rem;margin-right:.8rem;font-size:.9rem}
  </style>
</head>
<body class="abe-page">
<header class="abe-header">
  <div class="intake-wrap">
    <a href="/abe---flag/index.html" class="chip">← Home</a>
    <h1>Intake — Document + OCR Bridge</h1>
    <p class="tagline">
      Turn tickets, CPS letters, loan contracts, and policy memos into structured files that CIRI, CDA, CFF, and CCRI can use — all in your browser.
    </p>
    <nav class="chip-row">
      <span class="chip">No logins · No tracking · Local-only OCR</span>
      <a class="chip" href="ciri/index.html">CIRI</a>
      <a class="chip" href="cff/index.html">CFF</a>
      <a class="chip" href="ccri/index.html">CCRI</a>
      <a class="chip" href="system/index.html">System Map</a>
    </nav>
  </div>
</header>

<main class="abe-main intake-wrap">

  <!-- What this does -->
  <section class="card">
    <h2>What Intake Does</h2>
    <p class="small">
      Most people don’t start with a spreadsheet. They start with a <strong>ticket, letter, or contract</strong>.
      This page lets you upload that one document and turns it into:
    </p>
    <ul class="small">
      <li>A hash-locked <code class="mono">intake_artifact.json</code> you can attach to motions or reports.</li>
      <li>Optional helper files that other A.B.E. modules can use (CIRI CSV, CDA scenario, CFF/CCRI stubs).</li>
      <li>A plain-text view so you can see what the OCR actually read.</li>
    </ul>
    <p class="small">
      Everything runs locally. If you close this tab, your document goes with you — not to a server.
    </p>
  </section>

  <section class="card">
    <h2>1. Upload your document</h2>
    <div class="grid">
      <div>
        <div id="drop-zone" class="drop-zone">
          <strong>Drop a file here</strong><br/>
          <span class="small">Images (tickets), PDFs, or text files. Click to browse.</span><br/><br/>
          <input id="file-input" type="file" style="display:none" />
        </div>
        <p class="small" id="file-info">No file selected yet.</p>
      </div>
      <div>
        <label for="doc-type">
          <span>Document type</span><br/>
          <select id="doc-type">
            <option value="traffic_ticket">Traffic / citation ticket</option>
            <option value="cps_case">CPS / child welfare document</option>
            <option value="loan_contract">Loan / finance contract</option>
            <option value="policy_memo">Policy / memo / directive</option>
            <option value="generic_case_text">Generic case text</option>
          </select>
        </label>
        <div class="targets" style="margin-top:.6rem">
          <div class="small">Which modules should this feed?</div>
          <label><input type="checkbox" id="target-ciri" checked> <span>CIRI</span></label>
          <label><input type="checkbox" id="target-cda" checked> <span>CDA</span></label>
          <label><input type="checkbox" id="target-cff"> <span>CFF</span></label>
          <label><input type="checkbox" id="target-ccri"> <span>CCRI</span></label>
        </div>
        <button id="btn-process" class="btn" style="margin-top:.7rem">Run Intake (OCR + Normalize)</button>
        <p class="small" id="status-line" style="margin-top:.35rem">Waiting for a file…</p>
      </div>
    </div>
  </section>

  <section class="card">
    <h2>2. Preview what the engine sees</h2>
    <p class="small">
      This is the text actually seen by the intake engine, after OCR and basic cleanup.
      If it looks wrong, you can always rerun Intake with a clearer scan.
    </p>
    <pre id="intake-text" class="out-block mono">No text yet — run Intake first.</pre>
  </section>

  <section class="card">
    <h2>3. Intake artifact & downloads</h2>
    <p class="small">
      Once Intake runs, you can download a single JSON artifact that includes:
      the hash of your original file, normalized text, targets, and metadata for any helper files.
    </p>
    <button id="btn-download-intake" class="btn" disabled>Download intake_artifact.json</button>
    <p class="small" style="margin-top:.4rem">
      This artifact is designed to be attached to motions, auditor packets, or oversight reports.
      It proves what was uploaded and when, without exposing your original file.
    </p>
    <h3 style="margin-top:.8rem;font-size:1rem">Extracted fields (lightweight)</h3>
    <p class="small">
      Later versions will auto-detect things like citation number, dates, agencies, and dollar amounts.
      For now, Intake keeps a minimal, human-readable summary of what you ran.
    </p>
    <pre id="intake-fields" class="out-block mono">{}</pre>
  </section>

</main>

<footer class="abe-footer">
  <p>
    CC BY-NC 4.0 · DOI <a href="https://doi.org/10.5281/zenodo.17586107">10.5281/zenodo.17586107</a> · Integrity only — never for sale.
  </p>
</footer>

<!-- OCR engine -->
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
<!-- Intake logic -->
<script src="/abe---flag/intake/intake.js"></script>
</body>
</html>
