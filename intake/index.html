<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Intake & OCR (Local) | A.B.E.</title>

  <base href="/abe---flag/">
  <link rel="stylesheet" href="abe-patch/assets/abe-patch.css"/>

  <style>
    .wrap{max-width:1100px;margin:0 auto;padding:1.4rem 1rem 3rem;}
    .header h1{margin:.2rem 0 .25rem;font-size:1.85rem;line-height:1.15;}
    .tagline{max-width:880px;color:var(--muted);margin:.2rem 0 1rem;}
    .chip-row{display:flex;flex-wrap:wrap;gap:.5rem;margin:.5rem 0 0;}
    .chip{
      display:inline-flex;align-items:center;gap:.45rem;
      padding:.45rem .75rem;border-radius:999px;border:1px solid var(--line);
      background:#0b0f19;color:var(--ink);text-decoration:none;font-size:.9rem;cursor:pointer;
      user-select:none;
    }
    .chip:hover{border-color: rgba(93,223,255,.55);}
    .chip.alt{border-color: rgba(93,223,255,.35);box-shadow:0 0 0 1px rgba(93,223,255,.15) inset;}
    .chip.danger{border-color: rgba(255,133,133,.35);}

    .grid{display:grid;gap:1rem;}
    @media(min-width:980px){.grid{grid-template-columns:1.1fr .9fr;}}

    .card{
      background:#10131c;border:1px solid var(--line);border-radius:16px;
      padding:1rem 1rem 1.05rem;box-shadow:0 18px 40px rgba(0,0,0,.4);min-height:0;
    }
    .card h2{margin:.1rem 0 .35rem;font-size:1.05rem;}
    .sub{color:var(--muted);font-size:.9rem;margin:.1rem 0 .75rem;}
    .box{
      padding:.65rem .75rem;border:1px solid var(--line);border-radius:14px;
      background:#0b0f19;box-shadow:0 18px 40px rgba(0,0,0,.35);
    }
    .row{display:flex;flex-wrap:wrap;gap:.5rem;align-items:center;margin:.6rem 0;}
    label{color:var(--muted);font-size:.92rem;}
    input[type="file"]{color:var(--ink);max-width:100%;}
    textarea{
      width:100%;min-height:160px;resize:vertical;
      background:#050712;border:1px solid rgba(255,255,255,.08);
      border-radius:12px;color:var(--ink);padding:.7rem .75rem;
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
      font-size:.85rem;line-height:1.35;
    }
    pre.preview{
      margin:0;padding:.75rem .8rem;border-radius:12px;border:1px solid rgba(255,255,255,.08);
      background:#050712;color:var(--ink);overflow:auto;max-height:360px;
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
      font-size:.82rem;white-space:pre-wrap;word-break:break-word;
    }
    .list{margin:.3rem 0 0;padding-left:1.2rem;color:var(--muted);font-size:.92rem;}
    .hint{color:var(--muted);font-size:.88rem;margin-top:.55rem;}
    .kbd{
      display:inline-block;border:1px solid rgba(255,255,255,.16);border-bottom-width:2px;
      padding:.05rem .35rem;border-radius:8px;background:#0b0f19;font-size:.82rem;color:var(--ink);
    }
  </style>
</head>

<body class="abe-page">
<header class="abe-header">
  <div class="wrap header">
    <a class="chip" href="index.html">← A.B.E. Home</a>
    <h1>Intake & OCR Bridge (Local-only)</h1>
    <p class="tagline">
      Upload documents <strong>locally</strong> (nothing leaves your device). Intake builds a single, shared
      <strong>inputs.intake</strong> artifact that the rest of the engine can consume (CDA/CFF/CCRI/CIRI).
    </p>

    <nav class="chip-row">
      <a class="chip" href="law/index.html">Law Corpus</a>
      <a class="chip" href="cda/index.html">CDA</a>
      <a class="chip" href="cff/index.html">CFF</a>
      <a class="chip alt" href="integration/index.html">Integration</a>
    </nav>
  </div>
</header>

<main class="abe-main">
  <div class="wrap grid">

    <!-- LEFT: Intake Builder -->
    <section class="card">
      <h2>1) Upload Files (Optional)</h2>
      <p class="sub">
        This stores file metadata and (when possible) reads text locally for preview. PDFs/images are stored as metadata only unless you paste text below.
      </p>

      <div class="box">
        <div class="row">
          <label for="fileInput"><strong>Choose files:</strong></label>
          <input id="fileInput" type="file" multiple />
        </div>
        <div id="fileList"></div>

        <div class="row">
          <button class="chip alt" id="btnBuild" type="button">Build / Update inputs.intake</button>
          <button class="chip" id="btnDownloadIntake" type="button">Download intake_artifact.json</button>
          <button class="chip danger" id="btnClear" type="button">Clear Intake</button>
        </div>

        <p class="hint">
          Tip: If you have a PDF and no OCR yet, open it and paste the key text below.
          Use <span class="kbd">Ctrl</span> + <span class="kbd">F</span> inside the PDF viewer to find citations.
        </p>
      </div>

      <h2 style="margin-top:1rem;">2) Paste Text (Optional but powerful)</h2>
      <p class="sub">
        This is your “no-server OCR.” Paste ticket text, policy language, funding memos, contracts, etc.
        Intake will store it under <strong>inputs.intake.pasted_text</strong>.
      </p>
      <textarea id="pastedText" placeholder="Paste text here (local-only). Example: citation lines, officer notes, docket text, funding line items..."></textarea>

      <h2 style="margin-top:1rem;">3) Preview: inputs.intake</h2>
      <pre id="intakePreview" class="preview">No intake artifact built yet.</pre>
    </section>

    <!-- RIGHT: AI Assistant (Local, Deterministic) -->
    <section class="card">
      <h2>Intake “AI Assistant” (Local)</h2>
      <p class="sub">
        This is a local helper that explains what to upload and what each document type feeds.
        It does not phone home. It does not guess facts. It only summarizes what <em>you</em> provided.
      </p>

      <div class="box">
        <div class="row">
          <button class="chip alt" id="btnAdvise" type="button">Explain what to upload</button>
          <button class="chip alt" id="btnExplainIntake" type="button">Explain my current intake</button>
        </div>
        <pre id="assistantOut" class="preview">Click a button to get guidance.</pre>
      </div>

      <p class="hint">
        Non-negotiables enforced: local-only, no tracking, no logins, no people-scoring, integrity-first.
      </p>
    </section>

  </div>
</main>

<footer class="abe-footer">
  <p>A.B.E. — Intake & OCR Bridge · CC BY-NC 4.0 · Local-only.</p>
</footer>

<script type="module" src="intake/intake_ui.js"></script>
</body>
</html>
