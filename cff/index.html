<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>CFF ‚Äî Constitutional Funding Forensics | A.B.E.</title>
  <base href="/abe---flag/">
  <link rel="stylesheet" href="abe-patch/assets/abe-patch.css"/>
  <style>
    .cff-wrap{
      max-width:1100px;
      margin:0 auto;
      padding:1.5rem 1rem 3rem;
    }
    .cff-header h1{
      margin:0 0 .25rem;
      font-size:1.9rem;
    }
    .cff-header .tagline{
      max-width:780px;
      color:var(--muted);
      font-size:.98rem;
    }
    .cff-grid{
      display:grid;
      gap:1.1rem;
    }
    @media(min-width:900px){
      .cff-grid{
        grid-template-columns:1.4fr 1.6fr;
      }
    }
    .cff-card{
      background:var(--panel);
      border-radius:14px;
      border:1px solid var(--line);
      padding:1rem 1.1rem 1.2rem;
      box-shadow:0 18px 40px rgba(0,0,0,.45);
      min-height:0;
    }
    .cff-card h2{
      margin:.1rem 0 .4rem;
      font-size:1.15rem;
    }
    .cff-card h3{
      margin:.35rem 0 .3rem;
      font-size:1rem;
    }
    .cff-sub{
      color:var(--muted);
      font-size:.9rem;
    }
    .cff-upload{
      margin-top:.4rem;
      padding:.7rem .75rem;
      border-radius:12px;
      border:1px dashed var(--line);
      background:#050712;
      font-size:.88rem;
    }
    .cff-upload label{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:.45rem .9rem;
      border-radius:999px;
      border:1px solid var(--accent);
      background:#050712;
      color:var(--ink);
      cursor:pointer;
      gap:.35rem;
      margin-bottom:.3rem;
    }
    .cff-upload input[type="file"]{
      display:none;
    }
    .cff-file-name{
      display:block;
      font-size:.84rem;
      color:var(--muted);
      margin-top:.15rem;
    }
    .cff-mini{
      font-size:.82rem;
      color:var(--muted);
      margin-top:.25rem;
    }
    .cff-status{
      margin-top:.6rem;
      font-size:.84rem;
      color:var(--muted);
    }
    .cff-status-ok{color:#4bd28f;}
    .cff-status-warn{color:#ffba5c;}
    .cff-status-bad{color:#ff8585;}
    .cff-kpi-row{
      display:flex;
      flex-wrap:wrap;
      gap:.6rem;
      margin-top:.5rem;
    }
    .cff-kpi{
      flex:1 1 140px;
      min-width:140px;
      max-width:220px;
      background:#050712;
      border-radius:10px;
      border:1px solid var(--line);
      padding:.45rem .55rem .5rem;
      font-size:.85rem;
    }
    .cff-kpi-label{
      color:var(--muted);
      font-size:.82rem;
    }
    .cff-kpi-value{
      font-weight:600;
      font-size:1rem;
      margin-top:.1rem;
    }
    .cff-kpi-tag{
      font-size:.78rem;
      color:var(--muted);
      margin-top:.15rem;
    }
    pre{
      margin:.45rem 0 .7rem;
      background:#050712;
      border-radius:10px;
      border:1px solid var(--line);
      padding:.6rem .7rem;
      font-family:ui-monospace,SFMono-Regular,Consolas,monospace;
      font-size:.82rem;
      max-height:260px;
      overflow:auto;
      white-space:pre-wrap;
      color:var(--ink);
    }
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:.4rem;
      font-size:.82rem;
    }
    th,td{
      border:1px solid var(--line);
      padding:.3rem .35rem;
    }
    th{
      text-align:left;
      background:#090d18;
    }
    .cff-good{color:#4bd28f;}
    .cff-off{color:#ff8585;}
    .cff-unclear{color:#ffba5c;}
    .btn-run{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      margin-top:.6rem;
      padding:.42rem .95rem;
      border-radius:999px;
      border:1px solid var(--accent);
      background:#050712;
      color:var(--ink);
      font-size:.88rem;
      cursor:pointer;
      gap:.4rem;
    }
    .btn-run:hover{
      box-shadow:0 0 0 1px rgba(93,223,255,.36),0 0 18px rgba(93,223,255,.25);
    }
    .btn-download{
      margin-top:.45rem;
      padding:.36rem .85rem;
      border-radius:999px;
      border:1px solid var(--line);
      background:#050712;
      color:var(--ink);
      font-size:.84rem;
      cursor:pointer;
    }
    .btn-download:disabled{
      opacity:.5;
      cursor:default;
    }
    .cff-hash{
      font-size:.8rem;
      color:var(--muted);
      margin-top:.3rem;
    }
  </style>
</head>
<body class="abe-page">

<header class="abe-header">
  <div class="cff-wrap cff-header">
    <a href="/abe---flag/index.html" class="chip">‚Üê A.B.E. Home</a>
    <h1>CFF ‚Äî Constitutional Funding Forensics</h1>
    <p class="tagline">
      Upload a simple CSV of program line items and see which dollars are ON_MISSION, OFF_MISSION, or UNCLEAR ‚Äî
      based on how they match their own federal authority and funding rules.
    </p>
    <nav class="chip-row">
      <a class="chip" href="intake/index.html">Intake</a>
      <a class="chip" href="cda/index.html">CDA</a>
      <a class="chip" href="ciri/index.html">CIRI</a>
      <span class="chip chip-alt">CFF</span>
      <a class="chip" href="law/index.html">Law Corpus</a>
      <a class="chip" href="doctrine/index.html">Doctrines</a>
      <a class="chip" href="integration/index.html">Integration</a>
    </nav>
  </div>
</header>

<main class="abe-main">
  <div class="cff-wrap cff-grid">

    <!-- LEFT: upload + status -->
    <section class="cff-card">
      <h2>Step 1 ‚Äî Upload funding lines</h2>
      <p class="cff-sub">
        CFF expects a CSV with at least these columns:
      </p>
      <pre>program_name, federal_authority_citation, state_or_jurisdiction,
agency, line_item_description, spend_category_code, amount_usd</pre>
      <p class="cff-mini">
        <strong>spend_category_code</strong> must be one of:
        <code>ON_MISSION</code>, <code>OFF_MISSION</code>, or <code>UNCLEAR</code>.
        CFF totals these and produces a forensic summary + hash receipt.
      </p>

      <div class="cff-upload">
        <label>
          <span>üìé Choose CSV file</span>
          <input id="cff-file" type="file" accept=".csv,text/csv">
        </label>
        <span id="cff-file-name" class="cff-file-name">No file selected</span>
        <button id="cff-run" class="btn-run">
          <span>üßÆ Run CFF on this CSV</span>
        </button>
        <div id="cff-status" class="cff-status">Status: waiting for CSV‚Ä¶</div>
      </div>

      <p class="cff-mini">
        Intake bridge: if your Intake artifact points to specific grants or programs,
        use those names in <code>program_name</code> and <code>line_item_description</code>.
        CFF does not phone home ‚Äî everything happens in this tab.
      </p>
    </section>

    <!-- RIGHT: results -->
    <section class="cff-card">
      <h2>Step 2 ‚Äî Review totals & receipts</h2>

      <h3>2.1 ¬∑ Totals by category</h3>
      <div class="cff-kpi-row">
        <div class="cff-kpi">
          <div class="cff-kpi-label">ON_MISSION</div>
          <div id="kpi-on-count" class="cff-kpi-value">‚Äî</div>
          <div id="kpi-on-amount" class="cff-kpi-tag">‚Äî</div>
        </div>
        <div class="cff-kpi">
          <div class="cff-kpi-label">OFF_MISSION</div>
          <div id="kpi-off-count" class="cff-kpi-value cff-off">‚Äî</div>
          <div id="kpi-off-amount" class="cff-kpi-tag">‚Äî</div>
        </div>
        <div class="cff-kpi">
          <div class="cff-kpi-label">UNCLEAR</div>
          <div id="kpi-unc-count" class="cff-kpi-value cff-unclear">‚Äî</div>
          <div id="kpi-unc-amount" class="cff-kpi-tag">‚Äî</div>
        </div>
      </div>

      <h3>2.2 ¬∑ Sample rows (top 20)</h3>
      <div id="cff-table-container">
        <!-- table injected here -->
      </div>

      <h3>2.3 ¬∑ CFF artifact & hash</h3>
      <button id="cff-download-json" class="btn-download" disabled>
        ‚¨á Download cff_artifact.json
      </button>
      <button id="cff-download-summary" class="btn-download" disabled>
        ‚¨á Download cff_summary.csv
      </button>
      <div id="cff-hash" class="cff-hash">
        Audit hash: ‚Äî  
        (SHA-256 of the CFF artifact. Any tampering will change this value.)
      </div>
    </section>

  </div>
</main>

<footer class="abe-footer">
  <p>
    CC BY-NC 4.0 ¬∑ DOI <a href="https://doi.org/10.5281/zenodo.17586107">10.5281/zenodo.17586107</a> ¬∑ Integrity only ‚Äî never for sale.
  </p>
</footer>

<script src="cff/local.js"></script>
</body>
</html>
